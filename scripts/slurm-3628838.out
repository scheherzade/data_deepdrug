2018-11-15 10:44:59.952969: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-11-15 10:45:07.644724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1411] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:05:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-11-15 10:45:07.779851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1411] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:06:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-11-15 10:45:07.924132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1411] Found device 2 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:84:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-11-15 10:45:08.048697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1411] Found device 3 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:85:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-11-15 10:45:08.049538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1490] Adding visible gpu devices: 0, 1, 2, 3
2018-11-15 10:45:09.131642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-15 10:45:09.131693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:977]      0 1 2 3 
2018-11-15 10:45:09.131701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990] 0:   N Y N N 
2018-11-15 10:45:09.131706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990] 1:   Y N N N 
2018-11-15 10:45:09.131711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990] 2:   N N N Y 
2018-11-15 10:45:09.131715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990] 3:   N N Y N 
2018-11-15 10:45:09.132594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1103] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10759 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)
2018-11-15 10:45:09.231692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1103] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10759 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
2018-11-15 10:45:09.330601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1103] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10759 MB memory) -> physical GPU (device: 2, name: Tesla K80, pci bus id: 0000:84:00.0, compute capability: 3.7)
2018-11-15 10:45:09.449470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1103] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10759 MB memory) -> physical GPU (device: 3, name: Tesla K80, pci bus id: 0000:85:00.0, compute capability: 3.7)
]0;IPython: deepdrug/scriptstraining finished for epoch  1
Epoch: 1 batch:  1 cost = 58.61657  test accuracy: 0.919
[[3676  294]
 [  37   89]]
Epoch: 1 batch:  2 cost = 58.61657  test accuracy: 0.919
[[3671  294]
 [  39   92]]
Epoch: 1 batch:  3 cost = 58.61657  test accuracy: 0.916
[[3653  297]
 [  46  100]]
Epoch: 1 batch:  4 cost = 58.61657  test accuracy: 0.927
[[3716  261]
 [  38   81]]
Epoch: 1 batch:  5 cost = 58.61657  test accuracy: 0.916
[[3654  307]
 [  36   99]]
Epoch: 1 batch:  6 cost = 58.61657  test accuracy: 0.915
[[3669  305]
 [  42   80]]
training finished for epoch  2
Epoch: 2 batch:  1 cost = 51.03255  test accuracy: 0.750
[[2955 1015]
 [   7  119]]
Epoch: 2 batch:  2 cost = 51.03255  test accuracy: 0.740
[[2912 1053]
 [  10  121]]
Epoch: 2 batch:  3 cost = 51.03255  test accuracy: 0.757
[[2970  980]
 [  14  132]]
Epoch: 2 batch:  4 cost = 51.03255  test accuracy: 0.763
[[3015  962]
 [   8  111]]
Epoch: 2 batch:  5 cost = 51.03255  test accuracy: 0.754
[[2964  997]
 [  10  125]]
Epoch: 2 batch:  6 cost = 51.03255  test accuracy: 0.758
[[2996  978]
 [  13  109]]
training finished for epoch  3
Epoch: 3 batch:  1 cost = 46.97017  test accuracy: 0.744
[[2927 1043]
 [   7  119]]
Epoch: 3 batch:  2 cost = 46.97017  test accuracy: 0.736
[[2896 1069]
 [  11  120]]
Epoch: 3 batch:  3 cost = 46.97017  test accuracy: 0.753
[[2955  995]
 [  18  128]]
Epoch: 3 batch:  4 cost = 46.97017  test accuracy: 0.754
[[2980  997]
 [  12  107]]
Epoch: 3 batch:  5 cost = 46.97017  test accuracy: 0.748
[[2941 1020]
 [  14  121]]
Epoch: 3 batch:  6 cost = 46.97017  test accuracy: 0.746
[[2949 1025]
 [  16  106]]
training finished for epoch  4
Epoch: 4 batch:  1 cost = 44.57083  test accuracy: 0.911
[[3667  303]
 [  61   65]]
Epoch: 4 batch:  2 cost = 44.57083  test accuracy: 0.912
[[3670  295]
 [  65   66]]
Epoch: 4 batch:  3 cost = 44.57083  test accuracy: 0.911
[[3659  291]
 [  75   71]]
Epoch: 4 batch:  4 cost = 44.57083  test accuracy: 0.921
[[3715  262]
 [  61   58]]
Epoch: 4 batch:  5 cost = 44.57083  test accuracy: 0.911
[[3658  303]
 [  61   74]]
Epoch: 4 batch:  6 cost = 44.57083  test accuracy: 0.910
[[3672  302]
 [  67   55]]
training finished for epoch  5
Epoch: 5 batch:  1 cost = 44.18218  test accuracy: 0.835
[[3331  639]
 [  37   89]]
Epoch: 5 batch:  2 cost = 44.18218  test accuracy: 0.840
[[3348  617]
 [  39   92]]
Epoch: 5 batch:  3 cost = 44.18218  test accuracy: 0.845
[[3355  595]
 [  38  108]]
Epoch: 5 batch:  4 cost = 44.18218  test accuracy: 0.854
[[3417  560]
 [  36   83]]
Epoch: 5 batch:  5 cost = 44.18218  test accuracy: 0.843
[[3347  614]
 [  30  105]]
Epoch: 5 batch:  6 cost = 44.18218  test accuracy: 0.840
[[3355  619]
 [  36   86]]
training finished for epoch  6
Epoch: 6 batch:  1 cost = 43.29073  test accuracy: 0.905
[[3622  348]
 [  41   85]]
Epoch: 6 batch:  2 cost = 43.29073  test accuracy: 0.894
[[3575  390]
 [  44   87]]
Epoch: 6 batch:  3 cost = 43.29073  test accuracy: 0.899
[[3589  361]
 [  52   94]]
Epoch: 6 batch:  4 cost = 43.29073  test accuracy: 0.910
[[3658  319]
 [  48   71]]
Epoch: 6 batch:  5 cost = 43.29073  test accuracy: 0.903
[[3600  361]
 [  38   97]]
Epoch: 6 batch:  6 cost = 43.29073  test accuracy: 0.901
[[3615  359]
 [  45   77]]
training finished for epoch  7
Epoch: 7 batch:  1 cost = 40.38964  test accuracy: 0.908
[[3636  334]
 [  41   85]]
Epoch: 7 batch:  2 cost = 40.38964  test accuracy: 0.899
[[3595  370]
 [  43   88]]
Epoch: 7 batch:  3 cost = 40.38964  test accuracy: 0.903
[[3603  347]
 [  52   94]]
Epoch: 7 batch:  4 cost = 40.38964  test accuracy: 0.916
[[3677  300]
 [  44   75]]
Epoch: 7 batch:  5 cost = 40.38964  test accuracy: 0.906
[[3613  348]
 [  37   98]]
Epoch: 7 batch:  6 cost = 40.38964  test accuracy: 0.907
[[3635  339]
 [  42   80]]
training finished for epoch  8
Epoch: 8 batch:  1 cost = 39.92385  test accuracy: 0.904
[[3616  354]
 [  40   86]]
Epoch: 8 batch:  2 cost = 39.92385  test accuracy: 0.896
[[3580  385]
 [  41   90]]
Epoch: 8 batch:  3 cost = 39.92385  test accuracy: 0.898
[[3577  373]
 [  46  100]]
Epoch: 8 batch:  4 cost = 39.92385  test accuracy: 0.913
[[3659  318]
 [  39   80]]
Epoch: 8 batch:  5 cost = 39.92385  test accuracy: 0.900
[[3586  375]
 [  33  102]]
Epoch: 8 batch:  6 cost = 39.92385  test accuracy: 0.903
[[3613  361]
 [  38   84]]
training finished for epoch  9
Epoch: 9 batch:  1 cost = 39.51906  test accuracy: 0.904
[[3621  349]
 [  43   83]]
Epoch: 9 batch:  2 cost = 39.51906  test accuracy: 0.901
[[3603  362]
 [  44   87]]
Epoch: 9 batch:  3 cost = 39.51906  test accuracy: 0.902
[[3597  353]
 [  50   96]]
Epoch: 9 batch:  4 cost = 39.51906  test accuracy: 0.916
[[3676  301]
 [  44   75]]
Epoch: 9 batch:  5 cost = 39.51906  test accuracy: 0.907
[[3617  344]
 [  37   98]]
Epoch: 9 batch:  6 cost = 39.51906  test accuracy: 0.907
[[3636  338]
 [  44   78]]
training finished for epoch  10
Epoch: 10 batch:  1 cost = 39.41034  test accuracy: 0.923
[[3701  269]
 [  45   81]]
Epoch: 10 batch:  2 cost = 39.41034  test accuracy: 0.915
[[3668  297]
 [  50   81]]
Epoch: 10 batch:  3 cost = 39.41034  test accuracy: 0.917
[[3667  283]
 [  55   91]]
Epoch: 10 batch:  4 cost = 39.41034  test accuracy: 0.927
[[3727  250]
 [  50   69]]
Epoch: 10 batch:  5 cost = 39.41034  test accuracy: 0.918
[[3674  287]
 [  49   86]]
Epoch: 10 batch:  6 cost = 39.41034  test accuracy: 0.921
[[3703  271]
 [  51   71]]
training finished for epoch  11
Epoch: 11 batch:  1 cost = 37.69945  test accuracy: 0.931
[[3751  219]
 [  62   64]]
Epoch: 11 batch:  2 cost = 37.69945  test accuracy: 0.926
[[3724  241]
 [  64   67]]
Epoch: 11 batch:  3 cost = 37.69945  test accuracy: 0.925
[[3715  235]
 [  73   73]]
Epoch: 11 batch:  4 cost = 37.69945  test accuracy: 0.933
[[3773  204]
 [  69   50]]
Epoch: 11 batch:  5 cost = 37.69945  test accuracy: 0.925
[[3731  230]
 [  76   59]]
Epoch: 11 batch:  6 cost = 37.69945  test accuracy: 0.928
[[3747  227]
 [  66   56]]
training finished for epoch  12
Epoch: 12 batch:  1 cost = 37.79316  test accuracy: 0.929
[[3737  233]
 [  58   68]]
Epoch: 12 batch:  2 cost = 37.79316  test accuracy: 0.921
[[3701  264]
 [  60   71]]
Epoch: 12 batch:  3 cost = 37.79316  test accuracy: 0.923
[[3701  249]
 [  68   78]]
Epoch: 12 batch:  4 cost = 37.79316  test accuracy: 0.930
[[3755  222]
 [  66   53]]
Epoch: 12 batch:  5 cost = 37.79316  test accuracy: 0.922
[[3715  246]
 [  74   61]]
Epoch: 12 batch:  6 cost = 37.79316  test accuracy: 0.925
[[3733  241]
 [  66   56]]
training finished for epoch  13
Epoch: 13 batch:  1 cost = 37.36905  test accuracy: 0.906
[[3633  337]
 [  47   79]]
Epoch: 13 batch:  2 cost = 37.36905  test accuracy: 0.896
[[3590  375]
 [  52   79]]
Epoch: 13 batch:  3 cost = 37.36905  test accuracy: 0.900
[[3597  353]
 [  58   88]]
Epoch: 13 batch:  4 cost = 37.36905  test accuracy: 0.912
[[3668  309]
 [  51   68]]
Epoch: 13 batch:  5 cost = 37.36905  test accuracy: 0.902
[[3614  347]
 [  53   82]]
Epoch: 13 batch:  6 cost = 37.36905  test accuracy: 0.901
[[3622  352]
 [  53   69]]
training finished for epoch  14
Epoch: 14 batch:  1 cost = 36.91037  test accuracy: 0.907
[[3640  330]
 [  52   74]]
Epoch: 14 batch:  2 cost = 36.91037  test accuracy: 0.897
[[3603  362]
 [  58   73]]
Epoch: 14 batch:  3 cost = 36.91037  test accuracy: 0.901
[[3605  345]
 [  59   87]]
Epoch: 14 batch:  4 cost = 36.91037  test accuracy: 0.913
[[3675  302]
 [  54   65]]
Epoch: 14 batch:  5 cost = 36.91037  test accuracy: 0.906
[[3627  334]
 [  49   86]]
Epoch: 14 batch:  6 cost = 36.91037  test accuracy: 0.903
[[3631  343]
 [  53   69]]
training finished for epoch  15
Epoch: 15 batch:  1 cost = 36.96505  test accuracy: 0.908
[[3649  321]
 [  57   69]]
Epoch: 15 batch:  2 cost = 36.96505  test accuracy: 0.902
[[3624  341]
 [  60   71]]
Epoch: 15 batch:  3 cost = 36.96505  test accuracy: 0.903
[[3619  331]
 [  67   79]]
Epoch: 15 batch:  4 cost = 36.96505  test accuracy: 0.914
[[3687  290]
 [  64   55]]
Epoch: 15 batch:  5 cost = 36.96505  test accuracy: 0.907
[[3637  324]
 [  57   78]]
Epoch: 15 batch:  6 cost = 36.96505  test accuracy: 0.906
[[3649  325]
 [  58   64]]
training finished for epoch  16
Epoch: 16 batch:  1 cost = 35.88447  test accuracy: 0.917
[[3706  264]
 [  74   52]]
Epoch: 16 batch:  2 cost = 35.88447  test accuracy: 0.912
[[3677  288]
 [  71   60]]
Epoch: 16 batch:  3 cost = 35.88447  test accuracy: 0.912
[[3664  286]
 [  76   70]]
Epoch: 16 batch:  4 cost = 35.88447  test accuracy: 0.923
[[3732  245]
 [  71   48]]
Epoch: 16 batch:  5 cost = 35.88447  test accuracy: 0.913
[[3678  283]
 [  74   61]]
Epoch: 16 batch:  6 cost = 35.88447  test accuracy: 0.915
[[3700  274]
 [  76   46]]
training finished for epoch  17
Epoch: 17 batch:  1 cost = 35.85314  test accuracy: 0.908
[[3650  320]
 [  58   68]]
Epoch: 17 batch:  2 cost = 35.85314  test accuracy: 0.902
[[3622  343]
 [  60   71]]
Epoch: 17 batch:  3 cost = 35.85314  test accuracy: 0.900
[[3607  343]
 [  66   80]]
Epoch: 17 batch:  4 cost = 35.85314  test accuracy: 0.914
[[3692  285]
 [  69   50]]
Epoch: 17 batch:  5 cost = 35.85314  test accuracy: 0.900
[[3618  343]
 [  66   69]]
Epoch: 17 batch:  6 cost = 35.85314  test accuracy: 0.901
[[3635  339]
 [  66   56]]
training finished for epoch  18
Epoch: 18 batch:  1 cost = 35.91713  test accuracy: 0.910
[[3674  296]
 [  74   52]]
Epoch: 18 batch:  2 cost = 35.91713  test accuracy: 0.902
[[3633  332]
 [  70   61]]
Epoch: 18 batch:  3 cost = 35.91713  test accuracy: 0.902
[[3626  324]
 [  76   70]]
Epoch: 18 batch:  4 cost = 35.91713  test accuracy: 0.916
[[3704  273]
 [  71   48]]
Epoch: 18 batch:  5 cost = 35.91713  test accuracy: 0.906
[[3646  315]
 [  72   63]]
Epoch: 18 batch:  6 cost = 35.91713  test accuracy: 0.905
[[3660  314]
 [  75   47]]
training finished for epoch  19
Epoch: 19 batch:  1 cost = 35.65614  test accuracy: 0.904
[[3648  322]
 [  72   54]]
Epoch: 19 batch:  2 cost = 35.65614  test accuracy: 0.900
[[3619  346]
 [  64   67]]
Epoch: 19 batch:  3 cost = 35.65614  test accuracy: 0.898
[[3607  343]
 [  76   70]]
Epoch: 19 batch:  4 cost = 35.65614  test accuracy: 0.912
[[3687  290]
 [  72   47]]
Epoch: 19 batch:  5 cost = 35.65614  test accuracy: 0.901
[[3626  335]
 [  70   65]]
Epoch: 19 batch:  6 cost = 35.65614  test accuracy: 0.903
[[3645  329]
 [  70   52]]
training finished for epoch  20
Epoch: 20 batch:  1 cost = 35.50152  test accuracy: 0.921
[[3727  243]
 [  79   47]]
Epoch: 20 batch:  2 cost = 35.50152  test accuracy: 0.910
[[3676  289]
 [  78   53]]
Epoch: 20 batch:  3 cost = 35.50152  test accuracy: 0.912
[[3684  266]
 [  96   50]]
Epoch: 20 batch:  4 cost = 35.50152  test accuracy: 0.922
[[3737  240]
 [  78   41]]
Epoch: 20 batch:  5 cost = 35.50152  test accuracy: 0.912
[[3689  272]
 [  87   48]]
Epoch: 20 batch:  6 cost = 35.50152  test accuracy: 0.917
[[3713  261]
 [  80   42]]

Training complete for model  1 !
